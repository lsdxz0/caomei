# 草莓阅读与公众号推文助手

一个功能强大的PDF处理和图片分割工具，专为提升文档处理效率而设计。

## 主要功能

### 1. PDF转图片功能
- **批量处理**: 支持同时处理多个PDF文件
- **灵活设置**: 
  - DPI设置 (默认150)
  - 输出格式选择 (PNG/JPG)
  - 处理间隔选择 (0-10页)
- **输出选项**:
  - 原位置输出
  - 自定义输出位置
  - 自动创建以PDF文件名命名的文件夹
- **智能排序**:
  - 支持文件名自然排序
  - 可点击表头进行排序
  - 支持多列排序

### 2. 图片分割功能
- **两种分割模式**:
  - 通用模式:
    * 宽高比 > 1.2 时左右分割
    * 高宽比 > 1.2 时上下分割
    * 接近1:1 时不分割
  - 自定义模式:
    * 符合目标尺寸时竖向分割（上下切）
    * 不符合目标尺寸时横向分割（左右切）
    * 支持设置目标尺寸
- **特殊处理**:
  - 支持下半部分180°旋转
  - 首页特殊处理选项
- **输出管理**:
  - 支持原位置输出
  - 自定义输出位置
  - 自动创建时间戳文件夹
  - 保持原始文件夹结构

### 3. 文件管理功能
- **文件列表**:
  - 显示文件名、大小、格式、修改时间
  - 支持拖拽添加文件
  - 批量添加和删除
  - 自然排序支持
- **进度监控**:
  - 实时进度显示
  - 详细日志记录
  - 可暂停/继续处理
  - 支持中途终止

### 4. 文件合并功能

#### 功能介绍
文件合并功能可以智能地合并多个源文件夹中的同名文件和文件夹，支持以下特性：

1. 同名文件合并
   - 自动检测不同源文件夹中的同名文件
   - 支持不同类型的文件（如：1.mp3, 1.mp4 等）
   - 可设置最少匹配数量（默认为2）

2. 同名文件夹合并
   - 保持原有的目录层级结构
   - 自动合并同名文件夹下的所有内容
   - 支持子文件夹的递归合并

#### 合并规则
文件合并遵循以下规则：

1. 文件分类：
   - 根目录文件：直接以文件名（不含扩展名）作为合并依据
   - 子文件夹文件：以所在文件夹名作为合并依据

2. 合并策略：
   - 同名文件：保留在同一目录下
   - 同名文件夹：保持原有的目录结构

3. 输出结构：
   - 创建以同名项为名称的目录
   - 根目录文件直接放在该目录下
   - 子文件夹内容保持原有层级

#### 使用示例

假设有以下文件结构：
```
源文件夹1/
    1.mp4
源文件夹2/
    1.mp3
源文件夹3/
    1/
        1-1.jpg
        1-2.jpg
```

合并后的结果：
```
输出目录/1/
    1.mp4          # 来自源文件夹1的文件
    1.mp3          # 来自源文件夹2的文件
    1/             # 保持源文件夹3中的目录结构
        1-1.jpg
        1-2.jpg
```

#### 操作步骤

1. 添加源文件夹
   - 点击"添加文件夹"按钮
   - 选择包含要合并文件的文件夹
   - 可添加多个源文件夹

2. 设置合并选项
   - 最少匹配数量：设置需要合并的最少文件数
   - 输出位置：选择"原位置"或"自定义位置"
   - 自定义输出路径：选择合并文件的保存位置

3. 开始合并
   - 点击"开始"按钮开始合并
   - 可以随时暂停或停止合并过程
   - 查看进度条和日志了解合并状态

#### 注意事项

1. 文件命名
   - 合并基于文件名（不含扩展名）进行
   - 同名但不同类型的文件会被放在同一目录下

2. 目录结构
   - 源文件夹的层级结构会被保留
   - 子文件夹中的文件会保持原有的相对路径

3. 重复文件
   - 根目录下的同名同类型文件会自动添加序号
   - 子文件夹中的重复文件会保持原有文件名

## 使用说明

### 环境要求
- Python 3.11.3 或更高版本
- Visual C++ Runtime
- 必要的Python库:
  ```
  PyQt6==6.2.3
  PyMuPDF
  Pillow
  ```

### 安装步骤
1. 确保已安装Python 3.11.3及以上版本
2. 安装Visual C++ Runtime
3. 安装依赖库：
   ```bash
   pip install -r requirements.txt
   ```

### 使用方法

#### PDF转图片
1. 切换到"PDF转图片"标签页
2. 添加PDF文件：
   - 点击"添加文件"选择单个或多个PDF
   - 点击"添加文件夹"选择整个文件夹
   - 或直接拖拽文件到列表中
3. 设置处理参数：
   - DPI值（默认150）
   - 输出格式（PNG/JPG）
   - 处理间隔（0表示处理所有页面）
4. 选择输出位置：
   - 原位置：在PDF所在目录创建文件夹
   - 自定义位置：选择指定目录
5. 点击"开始处理"

#### 图片分割
1. 切换到"图片分割"标签页
2. 添加图片：
   - 支持PNG、JPG、JPEG、BMP、GIF格式
   - 可单个添加或选择文件夹
   - 支持拖拽添加
3. 选择分割模式：
   - 通用模式：自动判断分割方向
   - 自定义模式：根据目标尺寸决定分割方向
4. 设置特殊处理选项：
   - 底部旋转选项
   - 首页特殊处理
5. 选择输出位置：
   - 原位置：保持原始目录结构
   - 自定义位置：自动创建时间戳文件夹
6. 点击"开始分割"

### 图片分割输出目录结构

图片分割功能会保持源文件的目录结构，将分割结果输出到对应的目录中。

例如，对于以下源文件结构：
```
D:\图片库\
    └── 1\
        └── 01.jpg
        └── 02.jpg
        └── 03.jpg
    └── 2\
        └── 04.jpg
        └── 05.jpg
```

如果选择"自定义位置"并指定输出到 `E:\输出`，将得到以下结构：
```
E:\输出\
    └── 1\
        └── 01_part1.jpg
        └── 01_part2.jpg
        └── 02_part1.jpg
        └── 02_part2.jpg
        └── 03_part1.jpg
        └── 03_part2.jpg
    └── 2\
        └── 04_part1.jpg
        └── 04_part2.jpg
        └── 05_part1.jpg
        └── 05_part2.jpg
```

如果选择"原位置"，则分割结果将直接保存在源文件所在的目录中。

特点说明：
1. 保持原有的目录层级结构
2. 分割结果直接存放在对应目录下，不会为每个源文件创建子文件夹
3. 分割后的文件以原文件名为基础，添加 "_partN" 后缀
4. 支持多级目录结构，所有子目录都会被完整保留

## 注意事项

### PDF处理
- 建议先用少量文件测试设置是否合适
- DPI值越大，生成的图片质量越高，但文件也越大
- 处理大型PDF时可能需要较长时间
- 支持自然排序，确保文件按正确顺序处理

### 图片分割
- 自定义模式下图片尺寸匹配允许10%误差
- 分割后的图片会自动保存在以原文件名命名的文件夹中
- 支持批量处理多个图片
- 输出文件夹会自动包含时间戳，避免覆盖

### 通用提示
- 处理过程中可以随时暂停或停止
- 界面底部会显示处理进度和日志信息
- 如遇到问题，请查看日志了解详细信息
- 所有操作都支持撤销和重试

## 常见问题

### PyQt6 DLL加载问题
如果遇到PyQt6 DLL加载错误，请：
1. 确保已安装Visual C++ Runtime
2. 重新安装PyQt6：
   ```bash
   pip uninstall PyQt6
   pip install PyQt6==6.2.3
   ```

### 性能优化建议
- 处理大量文件时，建议适当调低DPI值
- 可以使用处理间隔功能减少输出文件数量
- 确保系统有足够的磁盘空间
- 使用自然排序功能确保文件顺序正确

## 更新日志

### v1.1.0
- 添加文件名自然排序功能
- 改进图片分割输出目录结构
- 添加时间戳自动命名
- 优化进度显示和日志记录
- 修复多个UI交互问题

### v1.0.0
- 实现PDF转图片基本功能
- 添加图片分割功能
- 支持批量处理
- 添加进度显示和日志记录

## 技术支持
如有问题或建议，请通过以下方式反馈：
- 提交Issue
- 发送邮件至技术支持

## 许可证
本项目采用MIT许可证
